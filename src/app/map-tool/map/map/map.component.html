<div class="map-wrapper" #mapEl>
  <app-mapbox
    [mapConfig]="mapConfig" 
    [eventLayers]="mapEventLayers"
    (ready)="onMapReady($event)"
    (zoom)="onMapZoom($event)"
    (featureClick)="onFeatureClick($event)"
    (hoverChanged)="onFeatureHover($event)"
    (moveEnd)="onMapMoveEnd($event)"
  >
  </app-mapbox>
</div>
<ng-content></ng-content>
<div class="map-ui-wrapper">
  <app-ui-map-legend *ngIf="showLegend" [choropleth]="selectedChoropleth" [bubbles]="selectedBubble" [layer]="selectedLayer"></app-ui-map-legend>   
  <app-location-cards
    *ngIf="activeFeatures.length > 0"
    [class.cards-2]="activeFeatures.length === 2"
    [class.cards-3]="activeFeatures.length === 3"
    [class.no-census-data]="!selectedChoropleth || selectedChoropleth.id.includes('none')"
    [features]="activeFeatures"
    [cardProperties]="cardProps"
    [year]="year"
    (clickedHeader)="clickedCardHeader.emit($event)"
    (dismissedCard)="dismissedCard.emit($event)"
    [dollarProps]="dollarProps"
    [percentProps]="percentProps"
  ></app-location-cards>
  <div class="map-ui" [class.active]="activeMenuItem === 'map'">
      <app-ui-select
          tabindex="4"
          class="eviction-select"
          [label]="'MAP.EVICTION_SELECT' | translate"
          labelProperty="name"
          [selectedValue]="selectedBubble"
          [values]="bubbleOptions"
          (change)="selectedBubble = $event"
          #pop="bs-tooltip"
          containerClass="map-hint-desktop"
          [isDisabled]="!tooltipEnabled"
          placement="bottom"
          [tooltip]="'HEADER.MAP_HINT' | translate"
      ></app-ui-select>
      <app-ui-select
          tabindex="5"
          class="highlight-select"
          [label]="'MAP.CENSUS_SELECT' | translate"
          labelProperty="name"
          [selectedValue]="selectedChoropleth"
          [values]="choroplethOptions"
          (change)="selectedChoropleth = $event">
      </app-ui-select>
      <app-ui-select
          tabindex="6"
          class="layer-select"
          [label]="'MAP.LAYER_SELECT' | translate"
          labelProperty="name"
          [selectedValue]="selectedLayer"
          [values]="selectDataLevels" 
          [bottomLabel]="selectDataLevels.length < layerOptions.length ? ('MAP.ZOOM_HINT' | translate) : false"
          (change)="setGroupVisibility($event)">
      </app-ui-select>
    </div>
</div>
<div class="year-slider-container">
  <app-ui-slider tabindex="9"
    class="year-slider"
    [label]="year"
    [(value)]="year" 
    [min]="2000" 
    [max]="2016" 
  ></app-ui-slider>
</div>