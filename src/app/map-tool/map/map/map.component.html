<div class="map-wrapper">
  <app-mapbox
      [mapConfig]="mapConfig" 
      [eventLayers]="mapEventLayers"
      (ready)="onMapReady($event)"
      (zoom)="onMapZoom($event)"
      (featureClick)="onFeatureClick($event)"
      (hoverChanged)="onFeatureHover($event)"
      (moveEnd)="onMapMoveEnd($event)"
  >
  </app-mapbox>
</div>
<div class="map-ui-wrapper">
  <app-progress-bar *ngIf="mapLoading"></app-progress-bar>
  <app-location-cards 
    *ngIf="activeFeatures.length > 0"
    [features]="activeFeatures"
    [year]="year"
    (viewMore)="viewMore.emit($event)"
    (clickedHeader)="clickedHeader.emit($event)"
    (dismissedCard)="dismissedCard.emit($event)"
  ></app-location-cards>
  <div class="map-ui">
      <app-ui-select
          tabindex="4"
          class="eviction-select"
          label="Eviction"
          labelProperty="name"
          [selectedValue]="selectedBubble"
          [values]="bubbleOptions"
          (change)="selectedBubble = $event"
      ></app-ui-select>
      <app-ui-select
          tabindex="5"
          class="highlight-select"
          label="Census Data"
          labelProperty="name"
          [selectedValue]="selectedChoropleth"
          [values]="choroplethOptions"
          (change)="selectedChoropleth = $event">
      </app-ui-select>
      <app-ui-select
          tabindex="6"
          class="layer-select"
          label="Map Level"
          labelProperty="name"
          [selectedValue]="selectedLayer"
          [values]="selectDataLevels" 
          [bottomLabel]="selectDataLevels.length < layerOptions.length ? 'Zoom for more' : false"
          (change)="setGroupVisibility($event)">
      </app-ui-select>
      <div 
        *ngIf="selectedChoropleth && selectedChoropleth.name !== 'None' && legend && legend.length" 
        class="map-legend" 
        [style.background]="getLegendGradient()"
      >
          <span class="legend-start">{{legend[1][0]}}</span>
          <span class="legend-end">{{legend[legend.length - 1][0]}}</span>
      </div>
      <app-ui-hint 
          *ngIf="selectedChoropleth && selectedChoropleth.name !== 'None' && legend && legend.length"
          class="legend-hint"
          [hint]="'The colored ' + selectedLayer['name'] + ' on the map represent ' + selectedChoropleth['name'] + ' from ' + legend[1][0] + ' to ' + legend[legend.length - 1][0] + '.'" 
          placement="bottom"
      ></app-ui-hint>
  </div>
  <div class="year-slider-container">
    <app-ui-slider tabindex="9"
      class="year-slider"
      [currentValue]="year" 
      [min]="1990" 
      [max]="2016" 
      (change)="year=$event"
    ></app-ui-slider>
  </div>
  
</div>