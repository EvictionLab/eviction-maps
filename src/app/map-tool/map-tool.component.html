<div id="top" class="app-wrapper">
  <app-map
    [mapConfig]="dataService.mapConfig"
    [bubbleOptions]="dataService.bubbleAttributes"
    [layerOptions]="dataService.dataLevels"
    [choroplethOptions]="dataService.dataAttributes"
    [scrollZoom]="enableZoom"
    [activeFeatures]="dataService.activeFeatures"
    [activeMenuItem]="activeMenuItem"
    [(boundingBox)]="dataService.mapView"
    [(year)]="dataService.activeYear"
    [(selectedBubble)]="dataService.activeBubbleHighlight"
    [(selectedChoropleth)]="dataService.activeDataHighlight"
    [(selectedLayer)]="dataService.activeDataLevel"
    (featureClick)="onFeatureSelect($event)"
    (boundingBoxChange)="updateRoute()"
    (yearChange)="updateRoute()"
    (selectedBubbleChange)="updateRoute()"
    (selectedChoroplethChange)="updateRoute()"
    (selectedLayerChange)="updateRoute()"
    (clickedCardHeader)="onCardHeaderClick($event)"
    (dismissedCard)="dataService.removeLocation($event); updateRoute()"
  >
    <div class="map-overlay" [class.active]="!enableZoom">
      <button
        class="btn btn-primary btn-large btn-compare z1" 
        [class.visible]="(dataService.activeFeatures.length > 0) && enableZoom"
        (click)="goToDataPanel($event)"
      >
        <span *ngIf="dataService.activeFeatures.length === 1">{{ 'MAP.DATA_LINK_SINGLE' | translate}}</span>
        <span *ngIf="dataService.activeFeatures.length > 1">{{ 'MAP.DATA_LINK_MULTIPLE' | translate}}</span>        
        <svg class="down-arrow" viewBox="0 0 14 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><polyline points="1 1 6.81226514 6 8.34418334 4.76222126 13 1.00035534"></polyline></svg>
      </button>
      <div class="show-map-overlay" (click)="goToTop()" [class.inactive]="enableZoom">
        <button class="btn btn-large btn-primary btn-map z1" >
          <svg class="up-arrow" viewBox="0 0 14 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polyline points="1 1 6.81226514 6 8.34418334 4.76222126 13 1.00035534"></polyline>
          </svg>
          <span>{{ 'DATA.MAP_LINK' | translate }}</span>              
        </button>
      </div>
    </div>
  </app-map>
  <!-- divider div used as a reference for scroll -->
  <div #divider></div>
  <app-data-panel
      id="data-panel"
      [style.display]="dataService.activeFeatures.length > 0 ? 'inherit' : 'none'"
      [year]="dataService.activeYear"
      [locations]="dataService.activeFeatures" 
      (locationRemoved)="dataService.removeLocation($event); updateRoute()"
      (locationAdded)="onSearchSelect($event, false)"
      [class.map-inactive]="!enableZoom"
  >
    <button (click)="goToTop()" class="btn btn-large btn-primary btn-map">
      <svg class="up-arrow" viewBox="0 0 14 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <g><polyline points="1 1 6.81226514 6 8.34418334 4.76222126 13 1.00035534"></polyline></g>
      </svg>
      <span>{{ 'DATA.MAP_LINK' | translate }}</span>
    </button>
  </app-data-panel>
</div>
